<!doctype html>
<html><head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>CMSimfly</title> <link rel="stylesheet" type="text/css" href="./../static/cmsimply.css">
<script src="tipuesearch_content.js"></script>
<script src="./../static/jquery.js"></script>
<link rel="stylesheet" href="./../static/tipuesearch/css/tipuesearch.css">
<script src="./../static/tipuesearch/tipuesearch_set.js"></script>
<script src="./../static/tipuesearch/tipuesearch.min.js"></script>

<script type="text/javascript" src="./../static/syntaxhighlighter/shCore.js"></script>
<script type="text/javascript" src="./../static/syntaxhighlighter/shBrushJScript.js"></script>
<script type="text/javascript" src="./../static/syntaxhighlighter/shBrushJava.js"></script>
<script type="text/javascript" src="./../static/syntaxhighlighter/shBrushPython.js"></script>
<script type="text/javascript" src="./../static/syntaxhighlighter/shBrushSql.js"></script>
<script type="text/javascript" src="./../static/syntaxhighlighter/shBrushXml.js"></script>
<script type="text/javascript" src="./../static/syntaxhighlighter/shBrushPhp.js"></script>
<script type="text/javascript" src="./../static/syntaxhighlighter/shBrushLua.js"></script>
<script type="text/javascript" src="./../static/syntaxhighlighter/shBrushCpp.js"></script>
<script type="text/javascript" src="./../static/syntaxhighlighter/shBrushCss.js"></script>
<script type="text/javascript" src="./../static/syntaxhighlighter/shBrushCSharp.js"></script>
<link type="text/css" rel="stylesheet" href="./../static/syntaxhighlighter/css/shCoreDefault.css"/>
<script type="text/javascript">SyntaxHighlighter.all();</script>

<!-- for LaTeX equations 暫時不用
<script src="https://scrum-3.github.io/web/math/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript"></script>
<script type="text/javascript">
init_mathjax = function() {
    if (window.MathJax) {
        // MathJax loaded
        MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
            },
            displayAlign: 'left', // Change this to 'center' to center equations.
            "HTML-CSS": {
                styles: {'.MathJax_Display': {"margin": 0}}
            }
        });
        MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
    }
}
init_mathjax();
</script>
-->
<!-- 暫時不用
<script src="./../static/fengari-web.js"></script>
<script type="text/javascript" src="./../static/Cango-13v08-min.js"></script>
<script type="text/javascript" src="./../static/CangoAxes-4v01-min.js"></script>
<script type="text/javascript" src="./../static/gearUtils-05.js"></script>
-->
<!-- for Brython 暫時不用
<script src="https://scrum-3.github.io/web/brython/brython.js"></script>
<script src="https://scrum-3.github.io/web/brython/brython_stdlib.js"></script>
-->
<style>
img {
    border:2px solid blue;
}
</style>

<script type="text/javascript">
/*shorthand of $(document).ready(function(){};); */
$(function(){
    $("ul.topmenu> li:has(ul) > a").append('<div class="arrow-right"></div>');
    $("ul.topmenu > li ul li:has(ul) > a").append('<div class="arrow-right"></div>');
});
function doSearch() {
     $('#tipue_search_input').tipuesearch({
        newWindow: true, minimumLength: 2
     });
}
$(document).ready(doSearch);
</script>

</head><header><h1>2019 Collaborative Product Design Internship BG1</h1> <confmenu>
<ul>
<li><a href="index.html">Home</a></li>
<li><a href="sitemap.html">Site Map</a></li>
<li><a href="./../reveal/index.html">reveal</a></li>
<li><a href="./../blog/index.html">blog</a></li>

</ul>
</confmenu></header>
<div class='container'><nav><ul id='css3menu1' class='topmenu'><div class="tipue_search_group"><input style="width: 6vw;" type="text" name="q" id="tipue_search_input" pattern=".{2,}" title="Press enter key to search" required></div><li><a href='各組期末報告說明.html'>各組期末報告說明</a><li><a href='執行規劃.html'>執行規劃</a><ul><li><a href='手足球系統模擬.html'>手足球系統模擬</a></li></ul><li><a href='設計與繪圖.html'>設計與繪圖</a><ul><li><a href='零組件尺寸分析.html'>零組件尺寸分析</a><li><a href='參數設計與繪圖.html'>參數設計與繪圖</a><li><a href='細部設計與 BOM.html'>細部設計與 BOM</a></li></ul><li><a href='V-rep 動態模擬.html'>V-rep 動態模擬</a><ul><li><a href='送球機構設計與模擬.html'>送球機構設計與模擬</a><li><a href='系統功能展示.html'>系統功能展示</a></li></ul><li><a href='結案報告.html'>結案報告</a><ul><li><a href='專案口頭簡報.html'>專案口頭簡報</a><li><a href='專案報告書.html'>專案報告書</a></li></ul><li><a href='Mid-term Report.html'>Mid-term Report</a><ul><li><a href='Introduction.html'>Introduction</a><li><a href='Onshape.html'>Onshape</a><ul><li><a href='Process.html'>Process</a><li><a href='Complete.html'>Complete</a></li></ul><li><a href='V-rep Tutorial.html'>V-rep Tutorial</a><ul><li><a href='BubbleRob.html'>BubbleRob</a></li></ul><li><a href='V-rep Table Football.html'>V-rep Table Football</a><ul><li><a href='Left player.html'>Left player</a></li></ul><li><a href='Progress.html'>Progress</a><ul><li><a href='03.html'>03</a><li><a href='06.html'>06</a><li><a href='11.html'>11</a><li><a href='12.html'>12</a><li><a href='16.html'>16</a><li><a href='21.html'>21</a><li><a href='22.html'>22</a><li><a href='28-1.html'>28-1</a><li><a href='28-2.html'>28-2</a><li><a href='33.html'>33</a><li><a href='40.html'>40</a><li><a href='45.html'>45</a></li></ul><li><a href='Experience.html'>Experience</a><ul><li><a href='40623203.html'>40623203</a><li><a href='40623206.html'>40623206</a><li><a href='40623211.html'>40623211</a><li><a href='40623212.html'>40623212</a><li><a href='40623216.html'>40623216</a><li><a href='40623221.html'>40623221</a><li><a href='40623222.html'>40623222</a><li><a href='40623228.html'>40623228</a><li><a href='40623233.html'>40623233</a><li><a href='40623240.html'>40623240</a><li><a href='40623245.html'>40623245</a></li></ul><li><a href='Attend.html'>Attend</a></li></ul></nav><section><div id="tipue_search_content">V-rep Tutorial << <a href='V-rep Tutorial.html'>Previous</a> <a href='V-rep Table Football.html'>Next</a> >> V-rep Table Football<br /><h1>BubbleRob</h1>
<p><a href="https://github.com/mdekmol/cd2019b-task1-2019cdb_t1_g1/tree/gh-pages/downloads">BubbleRob</a></p>
<p><img alt="" height="429" src="./../images/2019-04-01_23-32-24.gif" width="800"/></p>
<p class="title style-scope ytd-video-primary-info-renderer"><yt-formatted-string class="style-scope ytd-video-primary-info-renderer" force-default-style="">BubbleRob Tutorial simulation</yt-formatted-string></p>
<p><iframe allowfullscreen="allowfullscreen" height="314" src="//www.youtube.com/embed/boaF-xUQfeY" width="560"></iframe></p>
<p><iframe allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="allowfullscreen" frameborder="0" height="315" src="https://www.youtube.com/embed/tjL0Z86G73Y" width="560"></iframe></p>
<p>A. Add a primitive sphere</p>
<p>1. Add a primitive sphere to the scene with [Menu bar --&gt; Add --&gt; Primitive shape --&gt; Sphere]</p>
<p><img alt="" height="393" src="./../images/p37_09-48-54.png" width="800"/></p>
<p><span>2. Diameter 0.2, adjust the X-size item to 0.2, then click OK. </span></p>
<p><span><img caption="false" height="393" src="./../images/p37_09-57-52.png" width="500"/></span></p>
<p><span>3. Enable Collidable, Measurable, Renderable and Detectable in the object common properties for that shape.</span></p>
<p><span><img alt="" height="429" src="./../images/p37_19-13-52.png" width="800"/></span></p>
<p>4. Click the sphere representing BubbleRob's body.</p>
<p>5. Click translation tab and enter 0.02 for Along Z.</p>
<p>6. Click Translate selection so that all selected objects by 2 cm along the absolute Z-axis.</p>
<p><img alt="" height="429" src="./../images/p37_19-14-52.png" width="800"/></p>
<p>7. Double-click the sphere's name, edit and enter bubbleRob and press enter.</p>
<p>B. Add a proximity sensor</p>
<p>1. Select [Menu bar --&gt; Add --&gt; Proximity sensor --&gt; Cone type]</p>
<p><span><img alt="" height="393" src="./../images/p37_19-20-48.png" width="800"/></span></p>
<p><span>2.  In the orientation dialog on the orientation tab, we enter 90 for Around Y and for Around Z, then click Rotate selection.</span></p>
<p><span><img alt="" height="429" src="./../images/p37_19-25-16.png" width="800"/></span></p>
<p><span>3. In the position dialog, on the position tab, we enter 0.1 for X-coord. and 0.12 for Z-coord.</span></p>
<p><span><img alt="" height="429" src="./../images/p37_19-27-24.png" width="800"/></span></p>
<p>4. Double-click the proximity sensor's icon in the scene hierarchy to open its properties dialog.</p>
<p>5. Click Show volume parameter to open the proximity sensor volume dialog.</p>
<p>6. Adjust items Offset to 0.005, Angle to 30 and Range to 0.15.</p>
<p><img alt="" height="429" src="./../images/p37_19-37-18.png" width="800"/></p>
<p>7. Click Show detection parameters in the proximity sensor properties, opens the proximity sensor detection parameter dialog.</p>
<p>8. Uncheck item Don't allow detections if distance smaller than then close that dialog again.</p>
<p><img caption="false" height="429" src="./../images/p37_21-24-12.png" width="800"/></p>
<p>9. Double-click the proximity sensor's name, edit and enter bubbleRob_sensingNose and press enter.</p>
<p>C. Attaches the sensor to the body of the robot</p>
<p>1. Select bubbleRob_sensingNose, then control-select bubbleRob</p>
<p>2. Click [Menu bar --&gt; Edit --&gt; Make last selected object parent]</p>
<p>1. + 2. =&gt; Can also drag bubbleRob_sensingNose onto bubbleRob in the scene hierarchy.</p>
<p><img alt="" height="429" src="./../images/p37_21-37-27.png" width="800"/></p>
<p>D. Add BubbleRob's wheels</p>
<p>1. Add a pure primitive cylinder with [Menu bar --&gt; Add --&gt; Primitive shape --&gt; Cylinder]</p>
<p><img alt="" height="429" src="./../images/p37_21-42-55.png" width="800"/></p>
<p>2. Dimensions (0.08,0.08,0.02)</p>
<p><img alt="" height="429" src="./../images/p37_21-44-08.png" width="800"/></p>
<p>3. Enable Collidable, Measurable, Renderable and Detectable in the object common properties for that cylinder.</p>
<p><img alt="" height="429" src="./../images/p37_21-46-19.png" width="800"/></p>
<p>4. Set the cylinder's absolute position to (0.05,0.1,0.04)</p>
<p>5. A<span>bsolute orientation to (-90,0,0)</span></p>
<p><span>6. Change the name to <em>bubbleRob_leftWheel</em></span></p>
<p><span>7. Copy and paste the wheel</span></p>
<p><span>8. Set the absolute Y coordinate of the copy to -0.1</span></p>
<p><img alt="" height="429" src="./../images/p37_22-00-18.png" width="800"/></p>
<p>9. R<span>ename the copy to </span><em>bubbleRob_rightWheel</em></p>
<p>E. A<span>dd </span><a href="http://www.coppeliarobotics.com/helpFiles/en/joints.htm">j</a>oints<span><span> </span>(or motors) for the wheels</span></p>
<p><span>1. Click [Menu bar --&gt; Add --&gt; Joint --&gt; Revolute] to add a revolute joint to the scene </span></p>
<p><img alt="" height="429" src="./../images/p37_22-01-45.png" width="800"/></p>
<p>2. <span>Keep the joint selected, then control-select </span><em>bubbleRob_leftWheel</em></p>
<p>3.  In the position dialog, on the position tab, we click the Apply to selection button: this positioned the joint at the center of the left wheel.</p>
<p><img alt="" height="429" src="./../images/p37_22-11-38.png" width="800"/></p>
<p>4. In the orientation dialog, on the orientation tab, we do the same: this oriented the joint in the same way as the left wheel.</p>
<p><img alt="" height="429" src="./../images/p37_22-12-56.png" width="800"/></p>
<p>5. Rename the joint to bubbleRob_leftMotor</p>
<p>6. Double-click the joint's icon in the scene hierarchy to open the joint properties dialog.</p>
<p>7. click Show dynamic parameters to open the joint dynamics propertiesdialog.</p>
<p>8. Enable the motor, and check item Lock motor when target velocity is zero.</p>
<p><img alt="" height="429" src="./../images/p37_22-39-26.png" width="800"/></p>
<p>9. Repeat the same procedure for the right motor and rename it to bubbleRob_rightMotor.</p>
<p><img alt="" height="429" src="./../images/p37_22-43-48.png" width="800"/></p>
<p><img alt="" height="429" src="./../images/p37_22-45-04.png" width="800"/></p>
<p><img alt="" height="429" src="./../images/p37_22-56-27.png" width="800"/></p>
<p>10. Attach the left wheel to the left motor.</p>
<p><span>11. Attach </span>the right wheel to the right motor.</p>
<p>12. Attach the two motors to bubbleRob.</p>
<p>F. Add a small slider (or caster)</p>
<p>1. Add a pure primitive sphere with diameter 0.05</p>
<p>2. E<span>nter -0.07 for X-coord</span></p>
<p><img alt="" height="481" src="./../images/p37_14-06-37.png" width="800"/></p>
<p>3. Click the sphere Collidable, Measurable, Renderable and Detectable</p>
<p><img alt="" height="481" src="./../images/p37_13-49-21.png" width="800"/></p>
<p>4. Rename it to bubbleRob_slider</p>
<p>5. Set the Material to noFrictionMaterial in the shape dynamics properties</p>
<p>G. Add a force sensor</p>
<p>1. <span>Click [Menu bar --&gt; Add --&gt; Joint --&gt; Revolute] to add  a force sensor</span></p>
<p><span><img alt="" height="481" src="./../images/p37_13-52-06.png" width="800"/></span></p>
<p>2. Rename it to bubbleRob_connection</p>
<p>3. E<span>nter -0.07 for X-coord, 0.05<span>for Z-coord</span></span></p>
<p><span><span><img alt="" height="481" src="./../images/p37_14-16-30.png" width="800"/></span></span></p>
<p>4. Attach it to the robot body</p>
<p><img alt="" height="481" src="./../images/p37_14-24-01.png" width="800"/></p>
<p>H. Avoid bubbleRob_slider and bubbleRob colliding with each other</p>
<p>1. In the shape dynamics properties, for bubbleRob_slider we set the local respondable mask to 00001111</p>
<p><img alt="" height="481" src="./../images/p37_14-26-07.png" width="800"/></p>
<p>2. For bubbleRob, we set the local respondable mask to 11110000</p>
<p><img alt="" height="481" src="./../images/p37_14-27-42.png" width="800"/></p>
<p>I. Stability of dynamic simulations is tightly linked to masses and inertias of the involved non-static shapes.</p>
<p>1. Select the two wheels and the slider, and in the shape dynamics dialog we click three times M=M*2 (for selection)</p>
<p><img alt="" height="481" src="./../images/p37_15-58-10.png" width="800"/></p>
<p><img alt="" height="481" src="./../images/p37_15-59-24.png" width="800"/></p>
<p><img alt="" height="481" src="./../images/p37_16-00-40.png" width="800"/></p>
<p>2. All selected shapes will have their masses multiplied by 8</p>
<p>3. Run the simulation again</p>
<p>4. In the joint dynamics dialog, we set the Target velocity to 50 for both motors.</p>
<p><img alt="" height="481" src="./../images/p37_16-08-15.png" width="800"/></p>
<p><img alt="" height="481" src="./../images/p37_16-09-47.png" width="800"/></p>
<p>J. Define a collection of objects that represent BubbleRob</p>
<p>1. Click [Menu bar --&gt; Tools --&gt; Collections] to open the collection dialog or open the dialog by clicking the appropriate toolbar button</p>
<p><img caption="false" height="100" src="./../images/p37_22-24-11.png" width="100"/></p>
<p>2. In the collection dialog, we click Add new collection.</p>
<p>3. Select bubbleRob in the scene hierarchy</p>
<p>4. Click Add in the collection dialog</p>
<p>5. Collection is now defined as containing all objects of the hierarchy tree starting at the bubbleRob object (the collection's composition is displayed in the Composing elements and attributes section)</p>
<p><img alt="" height="429" src="./../images/p37_20-52-04.png" width="800"/></p>
<p>6. To edit the collection name, we double-click it, and rename it to bubbleRob_collection. </p>
<p>K. Track the minimum distance between BubbleRob and any other object</p>
<p>1. Open the distance dialog with [Menu bar --&gt; Tools --&gt; Calculation module properties] or open the calculation module properties dialog with the appropriate toolbar button</p>
<p><img alt="" height="100" src="./../images/p37_22-31-56.png" width="100"/></p>
<p>2. In the distance dialog, click Add new distance object and select a distance pair: [collection] bubbleRob_collection - all other measurable objects in the scene.</p>
<p>3. Added a distance object that will measure the smallest distance between collection bubbleRob_collection (i.e. any measurable object in that collection) and any other measurable object in the scene.</p>
<p><img alt="" height="429" src="./../images/p37_22-01-42.png" width="800"/></p>
<p>4. Rename the distance object to bubbleRob_distance with a double-click in its name</p>
<p>L. Add a graph</p>
<p>1. Click [Menu bar --&gt; Add --&gt; Graph]</p>
<p><img alt="" height="429" src="./../images/p37_22-10-45.png" width="800"/></p>
<p>2. Rename it to bubbleRob_graph</p>
<p>3. Attach the graph to bubbleRob</p>
<p>4. Set the graph's absolute coordinates to (0,0,0.005)</p>
<p><img alt="" height="429" src="./../images/p37_22-18-50.png" width="800"/></p>
<p>5. Open the graph properties dialog by double-clicking its icon in the scene hierarchy</p>
<p>6. Uncheck Display XYZ-planes</p>
<p>7. Click Add new data stream to record and select Object: absolute x-position for the Data stream type, and bubbleRob_graph for the Object / item to record</p>
<p>8. Data stream of bubbleRob_graph's absolute x-coordinate (i.e. the bubbleRobGraph's object absolute x position will be recorded). </p>
<p>9. Record the y and z positions: we add those data streams in a similar way as above.</p>
<p>10. Click Add new data stream to record and select Distance: segment length for the Data stream type, and bubbleRob_distance for the Object / item to record</p>
<p>11. In the Data stream recording list, we now rename Data to bubbleRob_x_pos, Data0 to bubbleRob_y_pos, Data1 to bubbleRob_z_pos, and Data2 to bubbleRob_obstacle_dist.</p>
<p><img alt="" height="429" src="./../images/p37_22-29-34.png" width="800"/></p>
<p>12. Select bubbleRob_x_pos, bubbleRob_y_pos and bubbleRob_z_pos in the Data Stream recording list and in the Time graph properties section, uncheck Visible</p>
<p><img alt="" height="429" src="./../images/p37_22-31-23.png" width="800"/></p>
<p>13. Only the bubbleRob_obstacle_dist data stream will be visible in a time graph</p>
<p>14. Set-up a 3D curve that displays BubbleRob's trajectory</p>
<p>15. Click Edit 3D curves to open the XY graph and 3D curve dialog</p>
<p>16. Click Add new curve</p>
<p>17. In the dialog that pops open, we select bubbleRob_x_pos for the X-value item, bubbleRob_y_pos for the Y-value item and bubbleRob_z_pos for the Z-value item.</p>
<p><img alt="" height="429" src="./../images/p37_22-34-28.png" width="800"/></p>
<p>18. Rename the newly added curve from Curve to bubbleRob_path</p>
<p>19. Check the Relative to world item and set Curve width to 4</p>
<p><img alt="" height="429" src="./../images/p37_22-35-45.png" width="800"/></p>
<p>M. Add a pure primitive cylinder</p>
<p>1. <span>Add a pure primitive cylinder with [Menu bar --&gt; Add --&gt; Primitive shape --&gt; Cylinder]</span></p>
<p><img alt="" height="429" src="./../images/p37_20-56-24.png" width="800"/></p>
<p>2. Dimensions: (0.1, 0.1, 0.2)</p>
<p>3. Click the object translation toolbar button</p>
<p><img alt="" height="100" src="./../images/p37_22-58-35.png" width="100"/></p>
<p>4. Drag any point in the scene: the cylinder will follow the movement</p>
<p>5. Copy and paste the cylinder a few times</p>
<p>6. Move them to positions around BubbleRob (it is most convenient to perform that while looking at the scene from the top)</p>
<p>7. During object shifting, holding down the shift key allows to perform smaller shift steps. Holding down the ctrl key allows to move in an orthogonal direction to the regular direction(s).</p>
<p>8. Select the camera pan toolbar button</p>
<p>N. Finish BubbleRob as a model definition</p>
<p>1. Select the model base (i.e. object bubbleRob)</p>
<p>2. Check items Object is model base and Object/model can transfer or accept DNA in the object common properties: there is now a stippled bounding box that encompasses all objects in the model hierarchy.</p>
<p>3. Select the two joints, the proximity sensor and the graph, the proximity sensor and the graph</p>
<p>4. Don't show as inside model selection and click Apply to selection</p>
<p>5. The model bounding box now ignores the two joints and the proximity sensor</p>
<p>6. Disable camera visibility layer 2</p>
<p>7. Enable camera visibility layer 10 for the two joints and the force sensor</p>
<p>8. This effectively hides the two joints and the force sensor, since layers 9-16 are disabled by default</p>
<p>9. Select the vision sensor, the two wheels, the slider, and the graph</p>
<p>10. Select base of model instead</p>
<p>O. Add a vision sensor</p>
<p>1. Click [Menu bar --&gt; Add --&gt; Vision sensor --&gt; Perspective type]</p>
<p><img alt="" height="429" src="./../images/p37_22-21-26.png" width="800"/></p>
<p>2. Attach the vision sensor to the proximity sensor</p>
<p>3. Set the local position and orientation of the vision sensor to (0,0,0)</p>
<p><img alt="" height="429" src="./../images/p37_22-40-15.png" width="800"/></p>
<p>4. Open its properties dialog</p>
<p>5. Set the Far clipping plane item to 1, and the Resolution x and Resolution y items to 256 and 256</p>
<p><img alt="" height="429" src="./../images/p37_22-44-24.png" width="800"/></p>
<p>6. Open the vision sensor filter dialog by clicking Show filter dialog</p>
<p>7. Select the filter component Edge detection on work image and click Add filter</p>
<p>8. Position the newly added filter in second position (one position up, using the up button)</p>
<p><img alt="" height="429" src="./../images/p37_22-49-18.png" width="800"/></p>
<p>9. Double-click the newly added filter component and adjust its Threshold item to 0.2, then click OK</p>
<p><img alt="" height="429" src="./../images/p37_22-51-31.png" width="800"/></p>
<p>P. Add a floating view to the scene,</p>
<p>1. Right-click [Popup menu --&gt; View --&gt; Associate view with selected vision sensor] (we make sure the vision sensor is selected during that process)</p>
<p><img alt="" height="429" src="./../images/p37_23-04-13.png" width="800"/></p>
<p><img alt="" height="429" src="./../images/p37_23-05-22.png" width="800"/></p>
<p>Q. Add a small child script that will control BubbleRob's behavior</p>
<p>1. Click [Menu bar --&gt; Add --&gt; Associated child script --&gt; Non threaded]</p>
<p><img alt="" height="429" src="./../images/p37_23-07-29.png" width="800"/></p>
<p>2. Opened with [Menu bar --&gt; Tools --&gt; Scripts] or through the appropriate toolbar button.</p>
<p><img alt="" height="100" src="./../images/p37_23-31-15.png" width="100"/></p>
<p>3. Double-click the little script icon that appeared next to bubbleRob's name in the scene hierarchy</p>
<p>4. Copy and paste following code into the script editor</p>
<p><img alt="" height="429" src="./../images/p37_23-34-40.png" width="800"/></p>
<p><strong>BubbleRob Program：</strong></p>
<pre class="brush:lua;auto-links:false;toolbar:false" contenteditable="false">function sysCall_init()
    -- do some initialization here:

    -- Make sure you read the section on "Accessing general-type objects programmatically"
    -- For instance, if you wish to retrieve the handle of a scene object, use following instruction:
    --
    -- handle=sim.getObjectHandle('sceneObjectName')
    -- 
    -- Above instruction retrieves the handle of 'sceneObjectName' if this script's name has no '#' in it
    --
    -- If this script's name contains a '#' (e.g. 'someName#4'), then above instruction retrieves the handle of object 'sceneObjectName#4'
    -- This mechanism of handle retrieval is very convenient, since you don't need to adjust any code when a model is duplicated!
    -- So if the script's name (or rather the name of the object associated with this script) is:
    --
    -- 'someName', then the handle of 'sceneObjectName' is retrieved
    -- 'someName#0', then the handle of 'sceneObjectName#0' is retrieved
    -- 'someName#1', then the handle of 'sceneObjectName#1' is retrieved
    -- ...
    --
    -- If you always want to retrieve the same object's handle, no matter what, specify its full name, including a '#':
    --
    -- handle=sim.getObjectHandle('sceneObjectName#') always retrieves the handle of object 'sceneObjectName' 
    -- handle=sim.getObjectHandle('sceneObjectName#0') always retrieves the handle of object 'sceneObjectName#0' 
    -- handle=sim.getObjectHandle('sceneObjectName#1') always retrieves the handle of object 'sceneObjectName#1'
    -- ...
    --
    -- Refer also to sim.getCollisionhandle, sim.getDistanceHandle, sim.getIkGroupHandle, etc.
end

function sysCall_actuation()
    -- put your actuation code here
    --
    -- For example:
    --
    -- local position=sim.getObjectPosition(handle,-1)
    -- position[1]=position[1]+0.001
    -- sim.setObjectPosition(handle,-1,position)
end

function sysCall_sensing()
    -- put your sensing code here
end

function sysCall_cleanup()
    -- do some clean-up here
end

-- You can define additional system calls here:
--[[
function sysCall_suspend()
end

function sysCall_resume()
end

function sysCall_dynCallback(inData)
end

function sysCall_jointCallback(inData)
    return outData
end

function sysCall_contactCallback(inData)
    return outData
end

function sysCall_beforeCopy(inData)
    for key,value in pairs(inData.objectHandles) do
        print("Object with handle "..key.." will be copied")
    end
end

function sysCall_afterCopy(inData)
    for key,value in pairs(inData.objectHandles) do
        print("Object with handle "..key.." was copied")
    end
end

function sysCall_beforeDelete(inData)
    for key,value in pairs(inData.objectHandles) do
        print("Object with handle "..key.." will be deleted")
    end
    -- inData.allObjects indicates if all objects in the scene will be deleted
end

function sysCall_afterDelete(inData)
    for key,value in pairs(inData.objectHandles) do
        print("Object with handle "..key.." was deleted")
    end
    -- inData.allObjects indicates if all objects in the scene were deleted
end
--]]
function speedChange_callback(ui,id,newVal)
    speed=minMaxSpeed[1]+(minMaxSpeed[2]-minMaxSpeed[1])*newVal/100
end

function sysCall_init()
    -- This is executed exactly once, the first time this script is executed
    bubbleRobBase=sim.getObjectAssociatedWithScript(sim.handle_self) -- this is bubbleRob's handle
    leftMotor=sim.getObjectHandle("bubbleRob_leftMotor") -- Handle of the left motor
    rightMotor=sim.getObjectHandle("bubbleRob_rightMotor") -- Handle of the right motor
    noseSensor=sim.getObjectHandle("bubbleRob_sensingNose") -- Handle of the proximity sensor
    minMaxSpeed={-50*math.pi/180,300*math.pi/180} -- Min and max speeds for each motor
    backUntilTime=1 -- Tells whether bubbleRob is in forward or backward mode
    -- Create the custom UI:
        xml = '&lt;ui title="'..sim.getObjectName(bubbleRobBase)..' speed" closeable="false" resizeable="false" activate="false"&gt;'..[[
        &lt;hslider minimum="0" maximum="100" onchange="speedChange_callback" id="1"/&gt;
        &lt;label text="" style="* {margin-left: 300px;}"/&gt;
        &lt;/ui&gt;
        ]]
    ui=simUI.create(xml)
    speed=(minMaxSpeed[1]+minMaxSpeed[2])*0.5
    simUI.setSliderValue(ui,1,100*(speed-minMaxSpeed[1])/(minMaxSpeed[2]-minMaxSpeed[1]))
end

function sysCall_actuation()
    result=sim.readProximitySensor(noseSensor) -- Read the proximity sensor
    -- If we detected something, we set the backward mode:
    if (result&gt;0) then backUntilTime=sim.getSimulationTime()+4 end 

    if (backUntilTime&lt;sim.getSimulationTime()) then
        -- When in forward mode, we simply move forward at the desired speed
        sim.setJointTargetVelocity(leftMotor,-speed)
        sim.setJointTargetVelocity(rightMotor,-speed)
    else
        -- When in backward mode, we simply backup in a curve at reduced speed
        sim.setJointTargetVelocity(leftMotor,speed/2)
        sim.setJointTargetVelocity(rightMotor,speed/8)
    end
end

function sysCall_cleanup()
	simUI.destroy(ui)
end</pre>
<p>Finish</p>
<br />V-rep Tutorial << <a href='V-rep Tutorial.html'>Previous</a> <a href='V-rep Table Football.html'>Next</a> >> V-rep Table Football</div></section></div></body></html>